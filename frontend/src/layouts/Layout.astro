---
import "../styles/global.css";
import BottomNav from "../components/BottomNav";

interface Props {
  title: string;
  hideHeader?: boolean;
  allowZoom?: boolean;
  hideBottomNav?: boolean;
}

const {
  title,
  hideHeader = false,
  allowZoom = false,
  hideBottomNav = false,
} = Astro.props;
const pathname = Astro.url.pathname;
const showLogo =
  pathname === "/" || pathname === "/manga" || pathname === "/manga/";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Anime & Manga Streaming" />
    <meta
      name="viewport"
      content={`width=device-width, initial-scale=1.0, maximum-scale=${allowZoom ? "5.0" : "1.0"}, user-scalable=${allowZoom ? "yes" : "no"}`}
    />
    <link rel="icon" type="image/png" href="/logo.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <script>
      // Header scroll effect
      const header = document.getElementById("main-header");
      window.addEventListener("scroll", () => {
        if (window.scrollY > 10) {
          header?.classList.add("bg-[#141414]", "shadow-lg");
          header?.classList.remove(
            "bg-transparent",
            "bg-gradient-to-b",
            "from-black/70",
            "to-transparent"
          );
        } else {
          header?.classList.remove("bg-[#141414]", "shadow-lg");
          header?.classList.add(
            "bg-transparent",
            "bg-gradient-to-b",
            "from-black/70",
            "to-transparent"
          );
        }
      });
    </script>
  </head>
  <body
    class="bg-[#141414] text-white min-h-screen flex flex-col overflow-x-hidden"
  >
    {
      !hideHeader && (
        <header
          id="main-header"
          class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-gradient-to-b from-black/70 to-transparent h-16 md:h-20 flex items-center"
        >
          <nav class="container mx-auto px-4 md:px-12 flex items-center justify-between w-full">
            <div class="flex items-center gap-8">
              <a
                href="/"
                class:list={[
                  "text-2xl md:text-3xl font-bold text-[#E50914] tracking-tighter uppercase flex items-center gap-3",
                  { hidden: !showLogo },
                ]}
              >
                <img
                  src="/logo.png"
                  alt="AnimePlay Logo"
                  class="h-12 md:h-14 w-auto"
                />
                AnimePlay
              </a>
            </div>
          </nav>
        </header>
      )
    }

    <main class="flex-1 w-full pb-24">
      <slot />
    </main>

    {/* Mobile Bottom Navigation - Visible on ALL screens now, unless hidden */}
    {
      !hideBottomNav && (
        <div class="fixed bottom-0 left-0 right-0 z-50">
          <BottomNav client:idle />
        </div>
      )
    }
  </body>
</html>
